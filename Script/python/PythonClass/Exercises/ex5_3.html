<html>
<head>
<title>Python Training Exercises - Exercise 5.3</title>
</head>

<body>
<h1>Exercise 5.3</h1>

<table width=600 bgcolor="#e0e0ff" border=1 cellpadding=20>
<tr>
<td>
<b>Objectives:</b>
<ul>
<li>Learn how to customize the behavior of objects by redefining special methods.
<li>Change the way that user-defined objects get printed
<li>Create an object that seems to look like a dictionary, but which scrapes data
off of a web page whenever a lookup is made.
</ul>
<p>
<b>Files Created:</b> <ul>
  <li><tt>PythonClass/curprice.py</tt>
  <li><tt>PythonClass/printobj.py</tt>
  </ul>

<p>
<b>Files Modified:</b> None
</td>
</tr>
</table>

<p>

<b>(a) Better output for printing objects</b>

<p>
All Python objects have two string representations.  The first
representation is created by string conversion via <tt>str()</tt>
(which is called by <tt>print</tt>).   The string representation is
usually a nicely formatted version of the object meant for humans.
The second representation is a code representation of the object
created by <tt>repr()</tt> (or simply by viewing a value in the
interactive shell).   The code representation typically shows you the
code that you have to type to get the object.
</p>

<p>
The two representations of an object are often different. For example,
you can see the difference by trying the following:
</p>

<blockquote>
<pre>
>>> <b>s = 'Hello\nWorld'</b>
>>> <b>print str(s)</b>        # Notice nice output (no quotes)
Hello
World
>>> <b>print repr(s)</b>       # Notice the added quotes and escape codes
'Hello\nWorld'
>>> <b>print "%r" % s</b>      # Alternate way to get repr() string
'Hello\nWorld'
>>>
</pre>
</blockquote>

<p>
Both kinds of string conversions can be redefined in a class if it
defines the <tt>__str__()</tt> and <tt>__repr__()</tt> methods.
</p>

<p>
Modify the <tt>Stock</tt> object that you defined in <a href=
"ex5_1.html">Exercise 5.1</a> so that the <tt>__repr__()</tt> methods
produce more useful output.  For example:
</p>
<blockquote>
<pre>
>>> <b>goog = Stock('GOOG',100, 490.1)</b>
>>> <b>goog</b>
Stock('GOOG',100,490.1)
>>>
</pre>
</blockquote>

See what happens when you read a portfolio of stocks and view the resulting list after you have
made these changes.  For example:

<blockquote>
<pre>
>>> <b>import stock</b>
>>> <b>portfolio = stock.read_portfolio("Data/portfolio.dat")</b>
>>> <b>portfolio</b>
... see what the output is ...
>>>
</pre>
</blockquote>

<p>
<b>(b) Building a Mapping object</b>

<p>
One of the more interesting features of Python is that you can create your own objects that emulate the
behavior of built-in types such as dictionaries and lists.  Let's take a look at this in action.

<p>
Try fetching data from the following URL:

<blockquote>
<pre>
>>> <b>import urllib</b>
>>> <b>u = urllib.urlopen("http://finance.yahoo.com/d/quotes.csv?s=IBM&f=l1")</b>
>>> <b>u.read()</b>
'88.79\r\n'
>>>
</pre>
</blockquote>

The returned number in this example is the last trading price of IBM downloaded from
Yahoo Finance.

<p>
Using the above code as a guide, create an object <tt>CurrentPrices</tt> that minimally looks like a dictionary,
but which dynamically fetches the current price of a given stock whenever someone performs a lookup on a given name.   Put this code in a file <tt>curprice.py</tt>.

<p>
For example:

<blockquote>
<pre>
>>> <b>from curprice import CurrentPrices</b>
>>> <b>prices = CurrentPrices()</b>
>>> <b>prices['IBM']</b>
95.23
>>> <b>prices['IBM']</b>      # Some time later
95.27
>>>
</pre>
</blockquote>

<p>
<b>(c) An example of using getattr()</b>
</p>

<p>
In <a href="ex5_2.html">Exercise 5.2</a> you worked with a function
that made a table for a stock portfolio.  In a file
<tt>PythonClass/printobj.py</tt>, make a more generalized
function <tt>print_objects()</tt> that simply prints a table showing
user-specified attributes of a list of arbitrary objects.  Here's how
it should work:</p>

<blockquote>
<pre>
>>> <b>import stock</b>
>>> <b>portfolio = stock.read_portfolio("Data/portfolio.dat")</b>
>>> <b>from printobj import print_objects</b>
>>> <b>print_objects(portfolio,['name','shares'])</b>
      name     shares
---------- ----------
        AA        100
       IBM         50
       CAT        150
      MSFT        200
        GE         95
      MSFT         50
       IBM        100

>>> <b>print_objects(portfolio,['name','shares','date'])</b>
      name     shares       date
---------- ---------- ---------- 
        AA        100      UNDEF
       IBM         50      UNDEF
       CAT        150      UNDEF
      MSFT        200      UNDEF
        GE         95      UNDEF
      MSFT         50      UNDEF
       IBM        100      UNDEF
>>> 
</pre>
</blockquote>

<hr>
[ <a href="index.html">Index</a> | <a href="soln5_3.html">Solution</a>
| <a href="ex5_2.html">Back</a> | <a href="ex6_1.html">Next</a> ]
</body>
</html>
