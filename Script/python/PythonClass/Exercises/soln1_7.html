<html>
<head>
<title>Python Training Exercises</title>
</head>

<body>
<h1>Exercise 1.7 - Solution</h1>

<P>
<b>(a) Defining a function</b>

<pre>
# pcost.py

def portfolio_cost(filename):
    '''Computes the total cost (shares*price) of a portfolio file'''
    total_cost = 0.0

    f = open(filename)
    for line in f:
        fields = line.split()
        nshares    = int(fields[1])
        price      = float(fields[2])
        total_cost = total_cost + nshares*price
    return total_cost
</pre>
<hr>

<P>
<b>(b) Adding some error handling</b>

<pre>
# pcost.py

def portfolio_cost(filename):
    '''Computes the total cost (shares*price) of a portfolio file'''
    total_cost = 0.0

    f = open(filename)
    for line in f:
        fields = line.split()
        try:
            nshares    = int(fields[1])
            price      = float(fields[2])
            total_cost = total_cost + nshares*price

        # This catches errors in int() and float() conversions above
        except ValueError:
            print "Bad line:", line
    return total_cost
</pre>

<p>
Here is a version which
also catches <tt>IndexError</tt> exceptions:

<pre>
# pcost.py

def portfolio_cost(filename):
    '''Computes the total cost (shares*price) of a portfolio file'''
    total_cost = 0.0

    f = open(filename)
    for line in f:
        fields = line.split()
        try:
            nshares    = int(fields[1])
            price      = float(fields[2])
            total_cost = total_cost + nshares*price

        # This catches errors in int() and float() conversions above
        except ValueError:
            print "Bad line:", line
        except IndexError:
            pass   # Does nothing.  Exception is ignored
   return total_cost
</pre>

<hr>

<p><b>(c) Using a library function</b>

<pre>
# pcost.py

def portfolio_cost(filename):
    '''Computes the total cost (shares*price) of a portfolio file'''
    total_cost = 0.0

    f = open(filename)
    for line in f:
        fields = line.split()
        try:
            nshares    = int(fields[1])
            price      = float(fields[2])
            total_cost = total_cost + nshares*price

       # This catches errors in int() and float() conversions above
        except ValueError:
            print "Bad line:", line
        except IndexError:
            pass   # Does nothing.  Exception is ignored

    f.close()
    return total_cost

import glob
filelist = glob.glob("Data/portfolio*.dat")

for name in filelist:
    cost = portfolio_cost(name)
    print name, cost
</pre>


<hr>
[ <a href="ex1_7.html">Back</a> ]
</body>
</html>
